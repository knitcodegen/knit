(window.webpackJsonp=window.webpackJsonp||[]).push([[17],{414:function(e,t,a){"use strict";a.r(t);var s=a(56),r=Object(s.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"cryptographic-and-security-functions"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#cryptographic-and-security-functions"}},[e._v("#")]),e._v(" Cryptographic and Security Functions")]),e._v(" "),a("p",[e._v("Sprig provides a couple of advanced cryptographic functions.")]),e._v(" "),a("h2",{attrs:{id:"sha1sum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sha1sum"}},[e._v("#")]),e._v(" sha1sum")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("sha1sum")]),e._v(" function receives a string, and computes it's SHA1 digest.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('sha1sum "Hello world!"\n')])])]),a("h2",{attrs:{id:"sha256sum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sha256sum"}},[e._v("#")]),e._v(" sha256sum")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("sha256sum")]),e._v(" function receives a string, and computes it's SHA256 digest.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('sha256sum "Hello world!"\n')])])]),a("p",[e._v('The above will compute the SHA 256 sum in an "ASCII armored" format that is\nsafe to print.')]),e._v(" "),a("h2",{attrs:{id:"adler32sum"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#adler32sum"}},[e._v("#")]),e._v(" adler32sum")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("adler32sum")]),e._v(" function receives a string, and computes its Adler-32 checksum.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('adler32sum "Hello world!"\n')])])]),a("h2",{attrs:{id:"bcrypt"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#bcrypt"}},[e._v("#")]),e._v(" bcrypt")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("bcrypt")]),e._v(" function receives a string, and generates its "),a("code",[e._v("bcrypt")]),e._v(" hash.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('bcrypt "myPassword"\n')])])]),a("h2",{attrs:{id:"htpasswd"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#htpasswd"}},[e._v("#")]),e._v(" htpasswd")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("htpasswd")]),e._v(" function takes a "),a("code",[e._v("username")]),e._v(" and "),a("code",[e._v("password")]),e._v(" and generates a "),a("code",[e._v("bcrypt")]),e._v(" hash of the password. The result can be used for basic authentication on an "),a("a",{attrs:{href:"https://httpd.apache.org/docs/2.4/misc/password_encryptions.html#basic",target:"_blank",rel:"noopener noreferrer"}},[e._v("Apache HTTP Server"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('htpasswd "myUser" "myPassword"\n')])])]),a("p",[e._v("Note that it is insecure to store the password directly in the template.")]),e._v(" "),a("h2",{attrs:{id:"randbytes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#randbytes"}},[e._v("#")]),e._v(" randBytes")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("randBytes")]),e._v(" function accepts a count "),a("code",[e._v("N")]),e._v(" and generates a cryptographically\nsecure (uses "),a("code",[e._v("crypto/rand")]),e._v(") random sequence of "),a("code",[e._v("N")]),e._v(" bytes. The sequence is\nreturned as a base64 encoded string.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v("randBytes 24\n")])])]),a("h2",{attrs:{id:"derivepassword"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#derivepassword"}},[e._v("#")]),e._v(" derivePassword")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("derivePassword")]),e._v(' function can be used to derive a specific password based on\nsome shared "master password" constraints. The algorithm for this is\n'),a("a",{attrs:{href:"https://masterpassword.app/masterpassword-algorithm.pdf",target:"_blank",rel:"noopener noreferrer"}},[e._v("well specified"),a("OutboundLink")],1),e._v(".")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('derivePassword 1 "long" "password" "user" "example.com"\n')])])]),a("p",[e._v("Note that it is considered insecure to store the parts directly in the template.")]),e._v(" "),a("h2",{attrs:{id:"genprivatekey"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#genprivatekey"}},[e._v("#")]),e._v(" genPrivateKey")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genPrivateKey")]),e._v(" function generates a new private key encoded into a PEM\nblock.")]),e._v(" "),a("p",[e._v("It takes one of the values for its first param:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("ecdsa")]),e._v(": Generate an elliptic curve DSA key (P256)")]),e._v(" "),a("li",[a("code",[e._v("dsa")]),e._v(": Generate a DSA key (L2048N256)")]),e._v(" "),a("li",[a("code",[e._v("rsa")]),e._v(": Generate an RSA 4096 key")]),e._v(" "),a("li",[a("code",[e._v("ed25519")]),e._v(": Generate an Ed25519 key")])]),e._v(" "),a("h2",{attrs:{id:"buildcustomcert"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#buildcustomcert"}},[e._v("#")]),e._v(" buildCustomCert")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("buildCustomCert")]),e._v(" function allows customizing the certificate.")]),e._v(" "),a("p",[e._v("It takes the following string parameters:")]),e._v(" "),a("ul",[a("li",[e._v("A base64 encoded PEM format certificate")]),e._v(" "),a("li",[e._v("A base64 encoded PEM format private key")])]),e._v(" "),a("p",[e._v("It returns a certificate object with the following attributes:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Cert")]),e._v(": A PEM-encoded certificate")]),e._v(" "),a("li",[a("code",[e._v("Key")]),e._v(": A PEM-encoded private key")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ca := buildCustomCert "base64-encoded-ca-crt" "base64-encoded-ca-key"\n')])])]),a("p",[e._v("Note that the returned object can be passed to the "),a("code",[e._v("genSignedCert")]),e._v(" function\nto sign a certificate using this CA.")]),e._v(" "),a("h2",{attrs:{id:"genca"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#genca"}},[e._v("#")]),e._v(" genCA")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genCA")]),e._v(" function generates a new, self-signed x509 certificate authority using a\n2048-bit RSA private key.")]),e._v(" "),a("p",[e._v("It takes the following parameters:")]),e._v(" "),a("ul",[a("li",[e._v("Subject's common name (cn)")]),e._v(" "),a("li",[e._v("Cert validity duration in days")])]),e._v(" "),a("p",[e._v("It returns an object with the following attributes:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Cert")]),e._v(": A PEM-encoded certificate")]),e._v(" "),a("li",[a("code",[e._v("Key")]),e._v(": A PEM-encoded private key")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ca := genCA "foo-ca" 365\n')])])]),a("p",[e._v("Note that the returned object can be passed to the "),a("code",[e._v("genSignedCert")]),e._v(" function\nto sign a certificate using this CA.")]),e._v(" "),a("h2",{attrs:{id:"gencawithkey"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gencawithkey"}},[e._v("#")]),e._v(" genCAWithKey")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genCAWithKey")]),e._v(" function generates a new, self-signed x509 certificate authority using a\ngiven private key.")]),e._v(" "),a("p",[e._v("It takes the following parameters:")]),e._v(" "),a("ul",[a("li",[e._v("Subject's common name (cn)")]),e._v(" "),a("li",[e._v("Cert validity duration in days")]),e._v(" "),a("li",[e._v("Private key (PEM-encoded); DSA keys are not supported")])]),e._v(" "),a("p",[e._v("It returns an object with the following attributes:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Cert")]),e._v(": A PEM-encoded certificate")]),e._v(" "),a("li",[a("code",[e._v("Key")]),e._v(": A PEM-encoded private key")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ca := genCAWithKey "foo-ca" 365 (genPrivateKey "rsa")\n')])])]),a("p",[e._v("Note that the returned object can be passed to the "),a("code",[e._v("genSignedCert")]),e._v(" function\nto sign a certificate using this CA.")]),e._v(" "),a("h2",{attrs:{id:"genselfsignedcert"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#genselfsignedcert"}},[e._v("#")]),e._v(" genSelfSignedCert")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genSelfSignedCert")]),e._v(" function generates a new, self-signed x509 certificate using a\n2048-bit RSA private key.")]),e._v(" "),a("p",[e._v("It takes the following parameters:")]),e._v(" "),a("ul",[a("li",[e._v("Subject's common name (cn)")]),e._v(" "),a("li",[e._v("Optional list of IPs; may be nil")]),e._v(" "),a("li",[e._v("Optional list of alternate DNS names; may be nil")]),e._v(" "),a("li",[e._v("Cert validity duration in days")])]),e._v(" "),a("p",[e._v("It returns an object with the following attributes:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Cert")]),e._v(": A PEM-encoded certificate")]),e._v(" "),a("li",[a("code",[e._v("Key")]),e._v(": A PEM-encoded private key")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$cert := genSelfSignedCert "foo.com" (list "10.0.0.1" "10.0.0.2") (list "bar.com" "bat.com") 365\n')])])]),a("h2",{attrs:{id:"genselfsignedcertwithkey"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#genselfsignedcertwithkey"}},[e._v("#")]),e._v(" genSelfSignedCertWithKey")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genSelfSignedCertWithKey")]),e._v(" function generates a new, self-signed x509 certificate using a\ngiven private key.")]),e._v(" "),a("p",[e._v("It takes the following parameters:")]),e._v(" "),a("ul",[a("li",[e._v("Subject's common name (cn)")]),e._v(" "),a("li",[e._v("Optional list of IPs; may be nil")]),e._v(" "),a("li",[e._v("Optional list of alternate DNS names; may be nil")]),e._v(" "),a("li",[e._v("Cert validity duration in days")]),e._v(" "),a("li",[e._v("Private key (PEM-encoded); DSA keys are not supported")])]),e._v(" "),a("p",[e._v("It returns an object with the following attributes:")]),e._v(" "),a("ul",[a("li",[a("code",[e._v("Cert")]),e._v(": A PEM-encoded certificate")]),e._v(" "),a("li",[a("code",[e._v("Key")]),e._v(": A PEM-encoded private key")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$cert := genSelfSignedCertWithKey "foo.com" (list "10.0.0.1" "10.0.0.2") (list "bar.com" "bat.com") 365 (genPrivateKey "ecdsa")\n')])])]),a("h2",{attrs:{id:"gensignedcert"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gensignedcert"}},[e._v("#")]),e._v(" genSignedCert")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genSignedCert")]),e._v(" function generates a new, x509 certificate signed by the\nspecified CA, using a 2048-bit RSA private key.")]),e._v(" "),a("p",[e._v("It takes the following parameters:")]),e._v(" "),a("ul",[a("li",[e._v("Subject's common name (cn)")]),e._v(" "),a("li",[e._v("Optional list of IPs; may be nil")]),e._v(" "),a("li",[e._v("Optional list of alternate DNS names; may be nil")]),e._v(" "),a("li",[e._v("Cert validity duration in days")]),e._v(" "),a("li",[e._v("CA (see "),a("code",[e._v("genCA")]),e._v(")")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ca := genCA "foo-ca" 365\n$cert := genSignedCert "foo.com" (list "10.0.0.1" "10.0.0.2") (list "bar.com" "bat.com") 365 $ca\n')])])]),a("h2",{attrs:{id:"gensignedcertwithkey"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#gensignedcertwithkey"}},[e._v("#")]),e._v(" genSignedCertWithKey")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("genSignedCertWithKey")]),e._v(" function generates a new, x509 certificate signed by the\nspecified CA, using a given private key.")]),e._v(" "),a("p",[e._v("It takes the following parameters:")]),e._v(" "),a("ul",[a("li",[e._v("Subject's common name (cn)")]),e._v(" "),a("li",[e._v("Optional list of IPs; may be nil")]),e._v(" "),a("li",[e._v("Optional list of alternate DNS names; may be nil")]),e._v(" "),a("li",[e._v("Cert validity duration in days")]),e._v(" "),a("li",[e._v("CA (see "),a("code",[e._v("genCA")]),e._v(")")]),e._v(" "),a("li",[e._v("Private key (PEM-encoded); DSA keys are not supported")])]),e._v(" "),a("p",[e._v("Example:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('$ca := genCA "foo-ca" 365\n$cert := genSignedCert "foo.com" (list "10.0.0.1" "10.0.0.2") (list "bar.com" "bat.com") 365 $ca (genPrivateKey "ed25519")\n')])])]),a("h2",{attrs:{id:"encryptaes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#encryptaes"}},[e._v("#")]),e._v(" encryptAES")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("encryptAES")]),e._v(" function encrypts text with AES-256 CBC and returns a base64 encoded string.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('encryptAES "secretkey" "plaintext"\n')])])]),a("h2",{attrs:{id:"decryptaes"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#decryptaes"}},[e._v("#")]),e._v(" decryptAES")]),e._v(" "),a("p",[e._v("The "),a("code",[e._v("decryptAES")]),e._v(" function receives a base64 string encoded by the AES-256 CBC\nalgorithm and returns the decoded text.")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[e._v('"30tEfhuJSVRhpG97XCuWgz2okj7L8vQ1s6V9zVUPeDQ=" | decryptAES "secretkey"\n')])])])])}),[],!1,null,null,null);t.default=r.exports}}]);